---
layout: default
title: Migration from riot 2
---

{% include guide-tabs.html %}

## General info

Riot 3 is a big improvement to the issues we found in the previous release, please check in detail all the [release notes](/release-notes).

We have resolved many problems and they required a major release bump because they couldn't be fixed with the previous codebase.
However migrating from Riot 2 shouldn't be such a big deal and below we have listed all the main breaking changes that might be worth knowing.

## Breaking changes

### Deprecate `riot-tag`

The attribute `riot-tag` was deprecated in favor of `data-is`.

```html
<!-- not supported -->
<div riot-tag="my-tag"></div>

<!-- good -->
<div data-is="my-tag"></div>
```

Notice that now `data-is` could be used also in nested tags and it supports dynamic expressions

```html
<my-tag>
  <div data-is={ subComponent }></div>

  <script>
    this.subComponent = 'child-tag'
  </script>
</my-tag>
```

### Deprecate `name` and `id` to cache DOM nodes

The attributes `name` and `id` will be no longer used by riot to cache DOM references to the tag context.
Use the `ref` attribute instead.
You will get the references to DOMs or custom tags through `this.refs`. On the other hand, note that `this.tags` will have no named tags anymore now.

<span class="tag red">Warning</span> the `refs` object will be populated __only after__ the `mount` event

```html
<my-tag>
  <p ref="paragraph">Hello</p>
  <sub-tag ref="childtag"></sub-tag>
  <script>
    this.on('mount', function() {
      console.log(this.refs.paragraph) // => p node
      console.log(this.refs.childtag) // => sub-tag tag
    })
  </script>
</my-tag>
```

### Object loops

Object loops now will use a different syntax, before we used `key, value in object`, and now we switched to `value, key in object`
[related issue](https://github.com/riot/riot/issues/1420)

### Remove `riot.route`

The `riot.route` was removed from the riot core so you will be able to use any routing library that fits better to your needs.
We will still maintain the [`riot-route`](https://github.com/riot/route) that could be used with riot or also as standalone module

### No `update` and `updated` events triggered before the `mount`

Previously riot was firing the `update` and the `updated` event even before the `mount` event was triggered.
Now you can use `before-mount` and `mount` to mount properly your tags, the `update` and the `updated` event will be only fired on the consequent update calls

### Deprecate automatic `preventDefault`

Riot was automatically calling `event.preventDefault()` on any tag event, we thought this behavior was wrong and we decided to remove it.

```html
<my-tag>
  <form onsubmit={ ajaxSubmit }>
    <input>
  </form>

  <script>
    ajaxSubmit(event) {
      // in riot2 this was not needed
      event.preventDefault()
    }
  </script>
</my-tag>
```

### No more parent tags updates on events generated by custom children tags

In riot 2 an events generated by custom children tag in loops were triggering an update on the parent as well [riot/1319](https://github.com/riot/riot/issues/1319). In riot 3 if you need to update the parent from a custom looped child tag you will need to do it explicitly.

### Remove support for spaced events in `riot.observable`

We made the riot.observable 6x times faster than the previous release, to improve the performance we had to remove the spaced events support. Listening to `*` is still supported.

```js
var el = riot.observable()

// not supported
el.on('start stop', function() { /* */ })
el.trigger('start stop')

// use this instead
function cb() {}
el
  .on('start', cb)
  .on('stop', cb)

el
  .trigger('start')
  .trigger('stop')
```

### Scoped css by default

In riot 3 all the css will be scoped by default you will no longer need the `scoped` attribute on your `<style>` nodes. There is no option to disable this behavior at the moment.

### Deprecate `babel` 5.8

Now the `es6` parser will use the latest `babel` version [more info](/guide/compiler/#ecmascript-6). You can still manually configure your `es6` parser to use the old babel releases.

Notice that we support also `bubl√©` as alternative to babel

### Avoid to swallow silently template errors

In riot 2 you had to configure manually functions to catch the errors in your tags templates. In riot 3 all the templates errors
will be output using `console.error` whenever the `console` api is available

### All `value` attributes using expressions will be output as `riot-value` ([riot/1957](https://github.com/riot/riot/issues/1957))

```html
<my-tag>
  <!-- The value attribute will be compiled to riot-value in riot 3. -->
  <input-wrapper value={total} />
  <script>
    this.total = '$11'
  </script>
</my-tag>

<input-wrapper>
  <script>
    // riot3
    console.log(opts.riotValue)
    // riot2
    console.log(opts.value)
  </script>
</input-wrapper>
```
